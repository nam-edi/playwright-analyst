<!-- Section Tags -->
<div
  x-show="activeSection === 'tags'"
  x-transition:enter="transition ease-out duration-300"
  x-transition:enter-start="opacity-0 transform translate-y-4"
  x-transition:enter-end="opacity-100 transform translate-y-0"
>
  <div
    class="bg-white shadow rounded-lg flex flex-col"
    style="height: calc(100vh - 180px)"
  >
    <div class="px-6 py-4 border-b border-gray-200 flex-shrink-0">
      <div>
        <h3 class="text-lg font-medium text-gray-900">Gestion des Tags</h3>
        <p class="mt-1 text-sm text-gray-500">
          Modifiez les couleurs des tags existants pour vos projets
        </p>
      </div>
    </div>

    <!-- Liste des tags par projet -->
    <div
      class="flex-1 overflow-y-scroll"
      style="
        scrollbar-width: thin;
        scrollbar-color: #d1d5db #f3f4f6;
        min-height: 400px;
      "
    >
      {% regroup all_tags by project as tags_by_project %} {% for project_group
      in tags_by_project %}
      <div class="px-6 py-4 border-b border-gray-100 last:border-b-0">
        <div class="mb-4">
          <h4 class="text-lg font-semibold text-gray-900 flex items-center">
            <svg
              class="w-5 h-5 mr-2 text-gray-500"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
              ></path>
            </svg>
            {{ project_group.grouper.name }}
            <span class="ml-2 text-sm text-gray-500 font-normal"
              >({{ project_group.list|length }} tag{{
              project_group.list|length|pluralize }})</span
            >
          </h4>
        </div>

        {% if project_group.list %}
        <div class="space-y-2">
          {% for tag in project_group.list %}
          <div
            class="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"
          >
            <div class="flex items-center space-x-3 flex-1 min-w-0">
              <div
                class="w-5 h-5 rounded-full border border-gray-300 flex-shrink-0"
                style="background-color: {{ tag.color }};"
              ></div>
              <span class="text-sm font-medium text-gray-900 truncate"
                >{{ tag.name }}</span
              >
              <code
                class="text-xs text-gray-500 bg-white px-2 py-1 rounded border"
                >{{ tag.color }}</code
              >
            </div>
            <button
              onclick="editTagColor({{ tag.id }}, '{{ tag.name }}', '{{ tag.color }}')"
              class="ml-4 inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-blue-500 transition-colors flex-shrink-0"
            >
              <svg
                class="w-3 h-3 mr-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"
                ></path>
              </svg>
              Changer la couleur
            </button>
          </div>
          {% endfor %}
        </div>
        {% else %}
        <div class="text-center py-6">
          <svg
            class="w-8 h-8 mx-auto text-gray-400"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"
            ></path>
          </svg>
          <p class="mt-2 text-sm text-gray-500">Aucun tag pour ce projet</p>
        </div>
        {% endif %}
      </div>
      {% empty %}
      <div class="px-6 py-8 text-center">
        <svg
          class="w-12 h-12 mx-auto text-gray-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"
          ></path>
        </svg>
        <p class="mt-2 text-sm text-gray-500">
          Aucun tag trouv√© dans vos projets.
        </p>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
